<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Create a hover effect</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.47.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.47.0/mapbox-gl.css' rel='stylesheet' />
    <style>
        body { margin:0; padding:0; }
        /* #map { position:absolute; top:0; bottom:0; width:100%; } */
        #map { width:100%; height: 500px; }
    </style>
</head>
<body>

<div id='map'></div>
<script>
mapboxgl.accessToken = 'pk.eyJ1IjoiY29kYm9kIiwiYSI6IjhjbFE1aUUifQ.Gimi98Oh3Uex9WQZlb5Wkw';
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/streets-v9',
    center: [8.3859005, 49.0148775],
    zoom: 9
});
var hoveredStateId =  null;

map.on('load', function () {
    map.addSource("sites", {
        "type": "geojson",
        "data": {
          "type": "FeatureCollection",
          "features": [
            {
              "type": "Feature",
              "id": 2,
              "geometry": {
                "type": "Polygon",
                "coordinates": 
                [ [ 8.3859005, 49.0148775, 0.0 ], [ 8.3838674, 49.014983, 0.0 ], [ 8.3793398, 49.0151589, 0.0 ], [ 8.37812, 49.0152293, 0.0 ], [ 8.375065, 49.0152891, 0.0 ], [ 8.3733211, 49.0153594, 0.0 ], [ 8.3721624, 49.0155987, 0.0 ], [ 8.3698557, 49.016619, 0.0 ], [ 8.3695553, 49.0162812, 0.0 ], [ 8.369448, 49.0155002, 0.0 ], [ 8.369121, 49.0137069, 0.0 ], [ 8.3689064, 49.0122573, 0.0 ], [ 8.3687133, 49.0113003, 0.0 ], [ 8.3683485, 49.0102588, 0.0 ], [ 8.3678335, 49.0091187, 0.0 ], [ 8.3678979, 49.0083446, 0.0 ], [ 8.3680052, 49.0072467, 0.0 ], [ 8.3681768, 49.0058814, 0.0 ], [ 8.365795, 49.0045864, 0.0 ], [ 8.3673829, 49.0022356, 0.0 ], [ 8.3684825, 49.00068, 0.0 ], [ 8.3698178, 48.9997423, 0.0 ], [ 8.3726073, 49.0011078, 0.0 ], [ 8.3709979, 49.0030364, 0.0 ], [ 8.3726502, 49.0037402, 0.0 ], [ 8.3744097, 49.0047115, 0.0 ], [ 8.375901, 49.0058235, 0.0 ], [ 8.3778751, 49.0058657, 0.0 ], [ 8.3809436, 49.0057531, 0.0 ], [ 8.3839691, 49.0055842, 0.0 ], [ 8.3869538, 49.0054302, 0.0 ], [ 8.3870611, 49.0066407, 0.0 ], [ 8.3871898, 49.0075979, 0.0 ], [ 8.38734, 49.008752, 0.0 ], [ 8.3874214, 49.0105185, 0.0 ], [ 8.3876145, 49.01156, 0.0 ], [ 8.3876789, 49.0125311, 0.0 ], [ 8.3878291, 49.0135444, 0.0 ], [ 8.3880008, 49.0146422, 0.0 ], [ 8.3859005, 49.0148775, 0.0 ] ] 
                
              },
              "properties": {
                "id": 2,
                "name": "Oxford Street"
              }
            }
          ]
        }
    });

    // The feature-state dependent fill-opacity expression will render the hover effect
    // when a feature's hover state is set to true.
    map.addLayer({
        'id': 'sites-bold',
        'type': 'fill',
        'source': 'sites',
        'layout': {},
        'paint': {
          // 'circle-color': '#ff442b',
          'fill-color': ['case',
            ['boolean', ['feature-state', 'hover'], false],
              'red',
              'blue'
            ],
          'fill-opacity': 0.6,
          //'circle-stroke-color': 'cyan',
          //'circle-stroke-width': 1
        }
      });


    // When the user moves their mouse over the state-fill layer, we'll update the
    // feature state for the feature under the mouse.
    map.on("mousemove", "sites-bold", function(e) {
      // console.log('in', e.features)
      if (e.features.length > 0) {
          // if (this.hoveredStateId) {
          //     map.setFeatureState({source: 'sites', id: this.hoveredStateId}, { hover: false});
          // }
          this.hoveredStateId = e.features[0].properties.id;
          console.log('in-f-id', this.hoveredStateId)
          map.setFeatureState({source: 'sites', id: this.hoveredStateId}, { hover: true});
          console.log('in-f', e.features[0])
      }
      console.log('in', map.getFeatureState({source: 'sites', id: this.hoveredStateId}))
    });

    // When the mouse leaves the state-fill layer, update the feature state of the
    // previously hovered feature.
    map.on("mouseleave", "sites-bold", function() {
      console.log('out-id', this.hoveredStateId)
      // if (this.hoveredStateId) {
          map.setFeatureState({source: 'sites', id: this.hoveredStateId}, { hover: false});
      // }
      console.log('out', map.getFeatureState({source: 'sites', id: this.hoveredStateId}))
      hoveredStateId =  null;
    });
});
</script>

</body>
</html>